# Data frame à partir d’un fichier csv
ozone=read.csv2("ozone.csv")
# vérification
summary(ozone)
#1
reg=lm(maxO3~maxO3v +t9+T12+Ne12+Ne15+Vx12+Vx15, data=ozone)
#1
reg=lm(maxO3~maxO3v +T9+T12+Ne12+Ne15+Vx12+Vx15, data=ozone)
View(reg)
summary(reg)
plot(reg)
plot(maxO3,reg$fitted.values)
abline(a=0,b=1,lty=2, col=2)
plot(reg$fitted.values, reg$residuals)
plot(reg$residuals)
X~cbind(maxO3v,T9,T12,Ne12,Ne15,Vx12,Vx15)
dim(X)
round(cor(X),2)
# avant de faire régression on regarde la correlation entre les var explicatives
attach(ozone)
X~cbind(maxO3v,T9,T12,Ne12,Ne15,Vx12,Vx15)
dim(X)
attach(ozone)
X~cbind(maxO3v,T9,T12,Ne12,Ne15,Vx12,Vx15)
dim(X)
round(cor(X),2)
# avant de faire régression on regarde la correlation entre les var explicatives
attach(ozone)
X=cbind(maxO3v,T9,T12,Ne12,Ne15,Vx12,Vx15)
dim(X)
round(cor(X),2)
reg=lm(maxO3~maxO3v +T9+T12+Ne12+Ne15+Vx12+Vx15, data=ozone)
summary(reg)
plot(reg)
reg=lm(maxO3~maxO3v+T12+Ne12+Vx15, data=ozone)
summary(reg)
plot(reg)
res = reg$residuals
plot(reg$fitted.values, reg$residuals)
abline(h=0,col=2)
# résidus en fonction des var explicatives
plot(maxO3,reg$residuals)
plot(T9, reg$residuals)
noms=c('maxO3v','T12','Ne12','Vx15')
pos=c(12,4,7,11)
for(v in pos){
plot(x=ozone[,v],y=res,main=noms(ozone[v]))
abline(h=0, lty=2, col=2, lwd=2)
}
noms=c('maxO3v','T12','Ne12','Vx15')
pos=c(12,4,7,11)
for(v in pos){
plot(x=ozone[,v],y=res,main=names(ozone[v]))
abline(h=0, lty=2, col=2, lwd=2)
}
H=X%*%solve(t(X)%*%X)%*%t(X)
View(H)
dim(H)
inf<-influence(reg)
infl$hat
attach(ozone)
X=cbind(maxO3v,T12,Ne12,Vx15)
dim(X)
round(cor(X),2)
inf<-influence(reg)
infl$hat
inf<-influence(reg)
inf$hat
X=cbind(rep(1,112),maxO3v,T12,Ne12,Vx15)
inf<-influence(reg)
inf$hat
seuil = 2* dim(X)[2]/dim(X)[1]
plot(diag(h))
abline(h=seuil,col=3)
seuil = 2* dim(X)[2]/dim(X)[1]
plot(diag(h))
abline(h=seuil,col=3)
seuil = 2* dim(X)[2]/dim(X)[1]
plot(diag(H))
abline(h=seuil,col=3)
sigma2chap = sum(reg$residuals^2)/(dim(X)[1]-dim(X)[2]-1)
rstand= reg$residuals/sqrt(sigma2chap*(1-diag(H)))
plot(reg$fitted.values,rstand,main = "résidus standardisés")
plot(reg$fitted.values,rstand,main = "résidus standardisés")
abline(h=2,col=3)
abline(h=-2, col=3)
errtest = reg$residuals/(1-diag(H))
PRESS = sum(errtest^2)
sigma2chaptest =  sum(errtest^2)/(dim(X)[1]-dim(X)[2]-1)
rstud = reg$residuals/sqrt(sigma2chaptest*(1-diag(H)))
plot(reg$fitted.values,rstud,main = "résidus standardisés")
abline(h=2,col=3)
abline(h=-2, col=3)
Dcooks = cooks.distance(reg)
plot(Dcooks)
echgauss = rnorm(n=1000,mean=0,sd=1)
abline(a=0,b=1, col=2)
qqplot(rstand,echgauss)
echgauss = rnorm(n=1000,mean=0,sd=1)
qqplot(rstand,echgauss)
abline(a=0,b=1, col=2)
